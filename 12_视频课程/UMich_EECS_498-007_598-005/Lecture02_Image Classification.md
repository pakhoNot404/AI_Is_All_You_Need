# 图像分类

## 概念

图像分类问题，就是已有固定的分类标签集合，然后对于输入的图像，从分类标签集合中找出一个分类标签，最后把分类标签分配给该输入图像，或者简单的说，就是对于一个给定的图像，预测它属于哪个类别（或者给出属于一系列不同标签的可能性）。

## 困难和挑战

### 图像自身的问题
- 视角变化（Viewpoint variation）：同一个物体，摄像机可以从多个角度来展现，尽管可能角度的变化很轻微，但是可能使得这些数字发生不直观的某种改变
- 类内差异（Intra-class variation）：一类物体的个体之间的外形差异很大，比如椅子。这一类物体有许多不同的对象，每个都有自己的外形。比如说猫就是一种很会变形的生物
- 相似类（Fine-Grained Categories）：不同类物体的个体之间的外形差异小
- 背景干扰（Background clutter）：物体可能混入背景之中，使之难以被辨认
- 光照条件（Illumination conditions）：在像素层面上，光照的影响非常大，比如说光照和昏暗情况下图像会有不同情况
- 形变（Deformation）：很多东西的形状并非一成不变，会有很大变化。
- 遮挡（Occlusion）：目标物体可能被挡住。有时候只有物体的一小部分（可以小到几个像素）是可见的，比如说猫隐藏在草丛中，并不明显
- 大小变化（Scale variation）：物体可视的大小通常是会变化的（不仅是在图片中，在真实世界中大小也是变化的）。

### 类别不平衡问题

解决方法：
- [ ] 基于数据层面的方法
    
  - 随机过采样法ROS(random over-sampling)
  - 随即欠采样法RUS(random under-sampling)
  - 采用预训练模型
  - 动态采样
- [ ] 基于算法层面的方法

  - 修改损失函数
  - 代价敏感学习
  - 阈值移动
- [ ] 基于数据和算法混合的方法
  - LMLE
  - 深度过采样DOS
  - 困难样本挖掘(Online Hard Sample Mining)

## Nearest Neighbor分类器

**原理**：Nearest Neighbor算法将会将测试集和训练集中每一张图片去比较，然后将它认为最相似的那个训练集图片的标签赋给这张测试图片。

**评价指标**：如何比较两张图片的相似程度呢？（或者可以将相似程度理解为距离，距离越近，图片越相似）

**L1距离**：最简单的方法就是逐个像素比较，最后将差异值全部加起来。换句话说，就是将两张图片先转化为两个向量
$I_1$和
$I_2$，然后计算他们的L1距离（曼哈顿距离）。

$$d_1(I_1,I_2)=\sum_{p}|I_1^p-I_2^p|$$

![L1 distance](<../../Images/L1 distance.png>)

### 其他度量公式

- [ ] **L2欧式距离**：图像分类：在图像处理中，L2距离常用于计算图像特征向量之间的距离，从而判断图像的相似度或进行分类。
自然语言处理：在文本处理中，L2距离可以用来衡量两个词向量之间的距离，进而判断文本的语义相似性。

$$d_1(I_1,I_2)=\sqrt{\sum_{p}(I_1^p-I_2^p)}$$

- [ ] **余弦相似度**：余弦相似度是一种常用的衡量向量之间相似度的方法，它可以用于计算两个向量之间的夹角的余弦值。在图像相似度计算中，可以将图像转换为特征向量，然后使用余弦相似度来比较这些特征向量的相似程度。

$$\cos(\vec{a}\cdot\vec{b})=\frac{\vec{a}\cdot\vec{b}}{|a||b|}$$

    其中，分子为两个向量内积，分母为两个向量模（长度）的乘积。余弦相似度体现的是**方向的差异**。
    
    当夹角为0，值为1，两个向量同向；当夹角为90°，值为0，两个向量垂直；当夹角为180°，值为-1，两个向量反向。
    
    因此，余弦相似度的取值范围[-1, 1]，值越接近1表示两个向量越相似，越接近-1表示两个向量越不相似，接近0表示两个向量之间没有明显的相似性或差异。

- [ ] **MSE**：计算两张图片对应像素之间的差值的平方，并求取平均值来得到相似度评分。MSE算法只考虑像素级别的差异，可能无法准确地捕捉图像的纹理、结构等细节。
$$MSE=\frac{1}{N}\sum_{i=1}^{N}(x_i-y_i)^2$$

    其中，N是像素的总数，括号中表示两张图像X和Y相同位置上的像素灰度值的差值。

- [ ] 